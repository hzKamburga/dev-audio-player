(()=>{var m=Object.defineProperty;var c=Object.getOwnPropertySymbols;var f=Object.prototype.hasOwnProperty,v=Object.prototype.propertyIsEnumerable;var p=(i,t,e)=>t in i?m(i,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):i[t]=e,y=(i,t)=>{for(var e in t||(t={}))f.call(t,e)&&p(i,e,t[e]);if(c)for(var e of c(t))v.call(t,e)&&p(i,e,t[e]);return i};var o=class{constructor(t,e,a){this.audio=t,this.canvas=e,this.ctx=this.canvas.getContext("2d"),this.theme=a,this.isPlaying=!1,this.animationId=null,this.audioContext=null,this.analyser=null,this.source=null,this.init()}init(){let t=()=>{if(!this.audioContext){let e=window.AudioContext||window.webkitAudioContext;this.audioContext=new e,this.analyser=this.audioContext.createAnalyser(),this.source=this.audioContext.createMediaElementSource(this.audio),this.source.connect(this.analyser),this.analyser.connect(this.audioContext.destination),this.analyser.fftSize=256,this.bufferLength=this.analyser.frequencyBinCount,this.dataArray=new Uint8Array(this.bufferLength)}this.audioContext.state==="suspended"&&this.audioContext.resume(),this.audio.removeEventListener("play",t)};this.audio.addEventListener("play",t)}start(){this.isPlaying=!0,this.draw()}stop(){this.isPlaying=!1,this.animationId&&cancelAnimationFrame(this.animationId)}draw(){if(!this.isPlaying||(this.animationId=requestAnimationFrame(()=>this.draw()),!this.analyser))return;this.analyser.getByteFrequencyData(this.dataArray);let t=this.canvas.width,e=this.canvas.height,a=t/this.bufferLength*2.5,n,l=0;this.ctx.clearRect(0,0,t,e);for(let s=0;s<this.bufferLength;s++){n=this.dataArray[s]/2;let d=n+25*(s/this.bufferLength),h=250*(s/this.bufferLength),u=50;this.theme==="dark"?this.ctx.fillStyle=`rgb(${d},${h},${u})`:this.ctx.fillStyle=`rgb(${d},${h},${u})`,this.ctx.fillRect(l,e-n,a,n),l+=a+1}}};var g=`.dev-audio-player {\r
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;\r
  padding: 16px;\r
  border-radius: 8px;\r
  display: flex;\r
  flex-direction: column;\r
  gap: 12px;\r
  width: 100%;\r
  max-width: 400px;\r
  box-sizing: border-box;\r
  transition: background-color 0.3s, color 0.3s;\r
}\r
\r
.dev-audio-player.dark {\r
  background-color: #1a1a1a;\r
  color: #ffffff;\r
  border: 1px solid #333;\r
}\r
\r
.dev-audio-player.light {\r
  background-color: #f5f5f5;\r
  color: #333333;\r
  border: 1px solid #ddd;\r
}\r
\r
.dap-controls {\r
  display: flex;\r
  align-items: center;\r
  gap: 12px;\r
}\r
\r
.dap-play-btn {\r
  background: none;\r
  border: none;\r
  cursor: pointer;\r
  padding: 0;\r
  width: 32px;\r
  height: 32px;\r
  display: flex;\r
  align-items: center;\r
  justify-content: center;\r
  border-radius: 50%;\r
  transition: background-color 0.2s;\r
}\r
\r
.dev-audio-player.dark .dap-play-btn {\r
  fill: #fff;\r
}\r
\r
.dev-audio-player.dark .dap-play-btn:hover {\r
  background-color: rgba(255, 255, 255, 0.1);\r
}\r
\r
.dev-audio-player.light .dap-play-btn {\r
  fill: #333;\r
}\r
\r
.dev-audio-player.light .dap-play-btn:hover {\r
  background-color: rgba(0, 0, 0, 0.05);\r
}\r
\r
.dap-progress-container {\r
  flex-grow: 1;\r
  height: 4px;\r
  background-color: rgba(128, 128, 128, 0.3);\r
  border-radius: 2px;\r
  cursor: pointer;\r
  position: relative;\r
}\r
\r
.dap-progress-bar {\r
  height: 100%;\r
  background-color: #007bff;\r
  border-radius: 2px;\r
  width: 0%;\r
  transition: width 0.1s linear;\r
}\r
\r
.dap-time {\r
  font-size: 12px;\r
  font-variant-numeric: tabular-nums;\r
  min-width: 40px;\r
  text-align: right;\r
  opacity: 0.8;\r
}\r
\r
.dap-volume-container {\r
  display: flex;\r
  align-items: center;\r
  gap: 8px;\r
  width: 80px;\r
}\r
\r
.dap-volume-slider {\r
  width: 100%;\r
  height: 4px;\r
  -webkit-appearance: none;\r
  background: rgba(128, 128, 128, 0.3);\r
  border-radius: 2px;\r
  outline: none;\r
}\r
\r
.dap-volume-slider::-webkit-slider-thumb {\r
  -webkit-appearance: none;\r
  width: 12px;\r
  height: 12px;\r
  border-radius: 50%;\r
  background: #007bff;\r
  cursor: pointer;\r
}\r
\r
.dap-visualizer {\r
  width: 100%;\r
  height: 40px;\r
  border-radius: 4px;\r
  background-color: rgba(0, 0, 0, 0.2);\r
}\r
\r
.dev-audio-player.light .dap-visualizer {\r
  background-color: rgba(0, 0, 0, 0.05);\r
}\r
`;var r=class{constructor(t){if(this.options=y({src:"",autoplay:!1,loop:!1,volume:1,theme:"dark",container:"body"},t),this.container=document.querySelector(this.options.container),!this.container){console.error("DevAudioPlayer: Container not found");return}this.audio=new Audio,this.audio.crossOrigin="anonymous",this.audio.src=this.options.src,this.audio.loop=this.options.loop,this.audio.volume=this.options.volume,this.isPlaying=!1,this.visualizer=null,this.init()}init(){this.injectStyles(),this.render(),this.attachEvents(),this.loadPreference(),this.options.autoplay&&this.play().catch(t=>{console.log("Autoplay blocked by browser policy:",t.message),this.isPlaying=!1,this.updatePlayButton()})}injectStyles(){if(!document.getElementById("dev-audio-player-styles")){let t=document.createElement("style");t.id="dev-audio-player-styles",t.textContent=g,document.head.appendChild(t)}}render(){let t=document.createElement("div");t.className=`dev-audio-player ${this.options.theme}`,t.innerHTML=`
      <div class="dap-controls">
        <button class="dap-play-btn" aria-label="Play">
          <svg viewBox="0 0 24 24" width="24" height="24">
            <path d="M8 5v14l11-7z"/>
          </svg>
        </button>
        
        <div class="dap-progress-container">
          <div class="dap-progress-bar"></div>
        </div>
        
        <span class="dap-time">0:00</span>
        
        <div class="dap-volume-container">
          <input type="range" class="dap-volume-slider" min="0" max="1" step="0.01" value="${this.options.volume}">
        </div>
      </div>
      <canvas class="dap-visualizer" width="400" height="40"></canvas>
    `,this.container.appendChild(t),this.elements={player:t,playBtn:t.querySelector(".dap-play-btn"),progressBar:t.querySelector(".dap-progress-bar"),progressContainer:t.querySelector(".dap-progress-container"),timeDisplay:t.querySelector(".dap-time"),volumeSlider:t.querySelector(".dap-volume-slider"),canvas:t.querySelector(".dap-visualizer")},this.visualizer=new o(this.audio,this.elements.canvas,this.options.theme)}attachEvents(){this.elements.playBtn.addEventListener("click",()=>this.togglePlay()),document.addEventListener("keydown",t=>{t.code==="Space"&&document.activeElement.tagName!=="INPUT"&&(t.preventDefault(),this.togglePlay())}),this.audio.addEventListener("timeupdate",()=>this.updateProgress()),this.audio.addEventListener("ended",()=>{this.isPlaying=!1,this.updatePlayButton(),this.visualizer.stop()}),this.elements.progressContainer.addEventListener("click",t=>{let e=this.elements.progressContainer.getBoundingClientRect(),a=(t.clientX-e.left)/e.width;this.audio.currentTime=a*this.audio.duration}),this.elements.volumeSlider.addEventListener("input",t=>{this.audio.volume=t.target.value}),document.addEventListener("visibilitychange",()=>{document.hidden&&this.isPlaying?(this.pause(),this.wasPlayingBeforeHidden=!0):!document.hidden&&this.wasPlayingBeforeHidden&&(this.play(),this.wasPlayingBeforeHidden=!1)})}togglePlay(){this.isPlaying?this.pause():this.play()}play(){return this.audio.play().then(()=>{this.isPlaying=!0,this.updatePlayButton(),this.visualizer.start(),this.savePreference(!0)})}pause(){this.audio.pause(),this.isPlaying=!1,this.updatePlayButton(),this.visualizer.stop(),this.savePreference(!1)}updatePlayButton(){let t=this.isPlaying?'<path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>':'<path d="M8 5v14l11-7z"/>';this.elements.playBtn.innerHTML=`<svg viewBox="0 0 24 24" width="24" height="24">${t}</svg>`,this.elements.playBtn.setAttribute("aria-label",this.isPlaying?"Pause":"Play")}updateProgress(){let t=this.audio.currentTime/this.audio.duration*100;this.elements.progressBar.style.width=`${t}%`,this.elements.timeDisplay.textContent=this.formatTime(this.audio.currentTime)}formatTime(t){let e=Math.floor(t/60),a=Math.floor(t%60);return`${e}:${a.toString().padStart(2,"0")}`}savePreference(t){try{localStorage.setItem("dap-playing",t)}catch(e){}}loadPreference(){try{localStorage.getItem("dap-playing")==="true"&&this.options.autoplay}catch(t){}}};window.createPlayer=i=>new r(i);})();
